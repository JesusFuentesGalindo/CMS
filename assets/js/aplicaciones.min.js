var path_url=window.location.protocol+"//"+window.location.host,aplications,equipments;
$(document).ready(function(){$("#link_aplicaciones").addClass("active");$("#btn_create_aplication").on("click",function(){$("#frm_create_aplication").trigger("reset");$("#create_img_previa").attr("src",path_url+"/assets/img/aplicaciones/default.png");$("#modal_create_aplication").modal("show")});$("#frm_create_aplication").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=document.getElementById("create_img_aplication").files[0],
c=$("#create_txt_nombre").val(),d=$("#create_txt_description").val();a.append("a_name",c);a.append("a_description",d);a.append("a_img",b);$.ajax({url:path_url+"/aplicaciones/create_aplication",type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(aplications.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"),$("#modal_create_aplication").modal("hide"))},error:function(a){Swal.fire("Error!","La aplicaci\u00f3n no pudo ser creada!",
"error")}})}});$(".img_form").on("change",function(){let a=this.files[0];if("image/jpeg"!=a.type&&"image/png"!=a.type)$(this).val(""),Swal.fire("Error!","La imagen debe ser jpeg o png!","error");else if(25E4<a.size)$(this).val(""),Swal.fire("Error!","La imagen no debe pesar m\u00e1s de 200 Kilobytes!","error");else{let b=new FileReader;b.readAsDataURL(a);$(b).on("load",function(a){a=a.target.result;$(".img_previa").attr("src",a)})}});$(document).on("click",".edit_aplication",function(){$("#frm_edit_aplication").trigger("reset");
var a=$(this).closest("tr");let b=a.find("td:eq(0)").html();$("#edit_txt_nombre").val(a.find("td:eq(3)").text()).attr("a_id",$(b).val());$("#edit_txt_description").val(a.find("td:eq(4)").text());a=a.find("td:eq(1)").html();$("#edit_img_previa").attr("src",$(a).attr("src")).attr("id_img",$(a).attr("id"));$("#modal_edit_aplication").modal("show")});$("#frm_edit_aplication").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=
new FormData;let b=$("#edit_txt_nombre").attr("a_id"),c=document.getElementById("edit_img_aplication").files[0],d=$("#edit_txt_nombre").val(),e=$("#edit_txt_description").val();a.append("a_id",b);a.append("a_name",d);a.append("a_description",e);a.append("a_img",c);$.ajax({url:path_url+"/aplicaciones/update_aplication",type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(aplications.ajax.reload(null,!1),Swal.fire("Exito!",
a.message,"success"))},error:function(a){Swal.fire("Error!","La aplicaci\u00f3n no puedo ser actualizada!","error")}})}});$(document).on("click",".delete_aplication",function(){const a=Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});a.fire({title:"Est\u00e1s seguro?",text:"No podr\u00e1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminalo!",cancelButtonText:"No, cancela!",reverseButtons:!0}).then(b=>{b.value?
(b=$(this).attr("a_id"),$.ajax({url:path_url+"/aplicaciones/delete_aplication",type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"a_id="+b,success:function(a){a.error?Swal.fire("Error!",a.error.message,"error"):(aplications.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},error:function(a){console.log(a);Swal.fire("Error!","La aplicaci\u00f3n no pudo ser eliminada!","error")}})):b.dismiss===Swal.DismissReason.cancel&&a.fire("Cancelado","La aplicaci\u00f3n NO fue eliminada",
"error")})});$("#btn_link_equipment").on("click",function(){$("#frm_link_equipment").trigger("reset");$("#modal_link_equipment").modal("show")});$("#frm_link_equipment").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=$("#select_equipo").val(),c=$("#create_txt_equipo").val();a.append("a_id",b);a.append("pa_name",c);$.ajax({url:path_url+"/aplicaciones/link_equipment",type:"POST",data:a,contentType:!1,
processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(equipments.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"),$("#modal_link_equipment").modal("hide"))},error:function(a){Swal.fire("Error!","La aplicaci\u00f3n no pudo ser creada!","error")}})}});$(document).on("click",".edit_equipment",function(){$("#frm_edit_equipment").trigger("reset");let a=$(this).closest("tr"),b=a.find("td:eq(0)").html();$("#edit_select_equipo").val(a.find("td:eq(1)").text()).attr("pa_id",
$(b).val());$("#edit_txt_equipo").val(a.find("td:eq(3)").text());$("#modal_edit_equipment").modal("show")});$("#frm_edit_equipment").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=$("#edit_select_equipo").attr("pa_id"),c=$("#edit_select_equipo").val(),d=$("#edit_txt_equipo").val();a.append("pa_id",b);a.append("a_id",c);a.append("pa_name",d);$.ajax({url:path_url+"/aplicaciones/update_equipment",type:"POST",
data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(equipments.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},error:function(a){Swal.fire("Error!","La aplicaci\u00f3n no puedo ser actualizada!","error")}})}});$(document).on("click",".delete_equipment",function(){const a=Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});a.fire({title:"Est\u00e1s seguro?",
text:"No podr\u00e1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminalo!",cancelButtonText:"No, cancela!",reverseButtons:!0}).then(b=>{b.value?(b=$(this).attr("pa_id"),$.ajax({url:path_url+"/aplicaciones/delete_equipment",type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"pa_id="+b,success:function(a){a.error?Swal.fire("Error!",a.error.message,"error"):(equipments.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},
error:function(a){console.log(a);Swal.fire("Error!","La aplicaci\u00f3n no pudo ser eliminada!","error")}})):b.dismiss===Swal.DismissReason.cancel&&a.fire("Cancelado","La aplicaci\u00f3n NO fue eliminada","error")})});(function(){let a=0;aplications=$("#tbl_aplications").DataTable({ajax:{url:path_url+"/aplicaciones/read_aplications",method:"GET",cache:"false",dataSrc:""},columns:[{data:"a_id",render:function(a){return'<input type="hidden" value="'+a+'"/>'}},{data:"a_img",title:"Imagen",render:function(b){return'<img id="img_'+
a++ +'" class="img-thumbnail" width="50px" src="'+path_url+"/"+b+'"/>'}},{data:"username",title:"Usuario"},{data:"a_name",title:"Nombre"},{data:"a_description",title:"Descripci\u00f3n"},{data:"a_id",title:"Opciones",render:function(a){return'<div class="text-center"><div class="btn-group"><button a_id="'+a+'" class="btn btn-primary btn-sm edit_aplication"><i class="fas fa-edit"></i></button><button type="button" a_id="'+a+'" class="btn btn-danger btn-sm delete_aplication"><i class="fas fa-eraser"></i></button></div></div>'}}],
responsive:!0})})();(function(){equipments=$("#tbl_equipos").DataTable({ajax:{url:path_url+"/aplicaciones/read_equipments",method:"GET",cache:"false",dataSrc:""},columns:[{data:"pa_id",render:function(a){return'<input type="hidden" value="'+a+'"/>'}},{data:"a_id",title:"Id Aplicaci\u00f3n"},{data:"a_name",title:"Aplicaci\u00f3n"},{data:"pa_name",title:"Equipo"},{data:"pa_id",title:"Opciones",render:function(a){return'<div class="text-center"><div class="btn-group"><button pa_id="'+a+'" class="btn btn-primary btn-sm edit_equipment"><i class="fas fa-edit"></i></button><button type="button" pa_id="'+
a+'" class="btn btn-danger btn-sm delete_equipment"><i class="fas fa-eraser"></i></button></div></div>'}}],responsive:!0})})()});