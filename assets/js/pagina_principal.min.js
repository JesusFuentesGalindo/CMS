var path_url=window.location.protocol+"//"+window.location.host,avisos,brands,text_postions={1:"1 izquierda-arriba",2:"2 centro-arriba",3:"3 derecha-arriba",4:"4 izquierda-centro",5:"5 centro-centro",6:"6 derecha-centro",7:"7 izquierda-abajo",8:"8 centro-abajo",9:"9 derecha-abajo"};
$(document).ready(function(){$("#link_pagina_principal").addClass("active");$(".my-colorpicker2").colorpicker();$(".my-colorpicker2").on("colorpickerChange",function(a){$(".my-colorpicker2 .fa-square").css("color",a.color.toString())});$("#btn_crear_aviso").on("click",function(){$("#frm_agregar_aviso").trigger("reset");$("#create_img_previa").attr("src",path_url+"/assets/img/avisos/default.jpg");$(".my-colorpicker2 .fa-square").css("color","#060606");$("#modal_agregar_aviso").modal("show")});$("#frm_agregar_aviso").submit(function(a){a.preventDefault();
a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=document.getElementById("img_aviso").files[0],c=$("#frm_agregar_aviso #txt_nombre").val(),d=$("#frm_agregar_aviso #txt_texto").val(),e=$("#frm_agregar_aviso #select_posicion").val(),f=$("#frm_agregar_aviso #text_color").val(),g=$("#frm_agregar_aviso #select_producto").val();a.append("n_name",c);a.append("n_text",d);a.append("n_text_position",e);a.append("n_img",b);a.append("n_text_color",
f);a.append("n_product",g);$.ajax({url:path_url+"/pagina_principal/create_notice",type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(avisos.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"),$("#modal_agregar_aviso").modal("hide"))},error:function(a){Swal.fire("Error!","El aviso no pudo ser creado!","error")}})}});$(document).on("click",".delete_notice",function(){const a=Swal.mixin({customClass:{confirmButton:"btn btn-success",
cancelButton:"btn btn-danger"},buttonsStyling:!1});a.fire({title:"Est\u00e1s seguro?",text:"No podr\u00e1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminalo!",cancelButtonText:"No, cancela!",reverseButtons:!0}).then(b=>{b.value?(b=$(this).attr("n_id"),$.ajax({url:path_url+"/pagina_principal/delete_notice",type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"n_id="+b,success:function(a){a.error?Swal.fire("Error!",a.error.message,
"error"):(avisos.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},error:function(a){Swal.fire("Error!","El aviso no pudo ser eliminado!","error")}})):b.dismiss===Swal.DismissReason.cancel&&a.fire("Cancelado","El aviso NO fue eliminado","error")})});$(".img_form").on("change",function(){let a=this.files[0];if("image/jpeg"!=a.type&&"image/png"!=a.type)$(this).val(""),Swal.fire("Error!","La imagen debe ser jpeg o png!","error");else if(25E4<a.size)$(this).val(""),Swal.fire("Error!","La imagen no debe pesar m\u00e1s de 200 Kilobytes!",
"error");else{let b=new FileReader;b.readAsDataURL(a);$(b).on("load",function(a){a=a.target.result;$(".img_previa").attr("src",a)})}});$(document).on("click",".edit_notice",function(){$("#frm_edit_notice").trigger("reset");var a=$(this).closest("tr");let b=a.find("td:eq(0)").html();$("#edit_txt_nombre").val(a.find("td:eq(3)").text()).attr("n_id",$(b).val());$("#edit_txt_texto").val(a.find("td:eq(4)").text());$("#edit_select_posicion").val(parseInt(a.find("td:eq(5)").text().substr(0,1)));$("#edit_text_color").val(a.find("td:eq(6)").text());
$(".my-colorpicker2 .fa-square").css("color",a.find("td:eq(6)").text().toString());$("#edit_select_producto").val(a.find("td:eq(7)").text());a=a.find("td:eq(1)").html();$("#edit_img_previa").attr("src",$(a).attr("src")).attr("id_img",$(a).attr("id"));$("#modal_edit_notice").modal("show")});$("#frm_edit_notice").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{let b=new FormData;a=$("#frm_edit_notice #edit_txt_nombre").attr("n_id");
let c=document.getElementById("edit_img_aviso").files[0],d=$("#frm_edit_notice #edit_txt_nombre").val(),e=$("#frm_edit_notice #edit_txt_texto").val(),f=$("#frm_edit_notice #edit_select_posicion").val(),g=$("#frm_edit_notice #edit_text_color").val(),h=$("#frm_edit_notice #edit_select_producto").val();b.append("n_id",a);b.append("n_name",d);b.append("n_text",e);b.append("n_text_position",f);b.append("n_img",c);b.append("n_text_color",g);b.append("n_product",h);$.ajax({url:path_url+"/pagina_principal/update_notice",
type:"POST",data:b,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(avisos.ajax.reload(null,!1),Swal.fire("Aviso Actualizado!",a.message,"success"))},error:function(a){Swal.fire("Error!","El usuario "+b.username+" no puedo ser actualizado!","error")}})}});$("#btn_create_brand").on("click",function(){$("#frm_create_brand").trigger("reset");$("#brand_create_img_previa").attr("src",path_url+"/assets/img/marcas/default.jpg");
$("#modal_create_brand").modal("show")});$("#frm_create_brand").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=document.getElementById("brand_create_input_img").files[0],c=$("#brand_create_txt_name").val();a.append("b_name",c);a.append("b_img",b);$.ajax({url:path_url+"/pagina_principal/create_brand",type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?
Swal.fire("Error!",a.error.message,"error"):(brands.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"),$("#modal_create_brand").modal("hide"))},error:function(a){Swal.fire("Error!","La marca no pudo ser creado!","error")}})}});$(document).on("click",".edit_brand",function(){$("#frm_edit_brand").trigger("reset");var a=$(this).closest("tr");let b=a.find("td:eq(0)").html();$("#brand_edit_txt_name").val(a.find("td:eq(3)").text()).attr("b_id",$(b).val());a=a.find("td:eq(1)").html();$("#brand_edit_img_previa").attr("src",
$(a).attr("src")).attr("id_img",$(a).attr("id"));$("#modal_edit_brand").modal("show")});$("#frm_edit_brand").submit(function(a){a.preventDefault();a.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{a=new FormData;let b=$("#brand_edit_txt_name").attr("b_id"),c=document.getElementById("brand_edit_input_img").files[0],d=$("#brand_edit_txt_name").val();a.append("b_id",b);a.append("b_name",d);a.append("b_img",c);$.ajax({url:path_url+"/pagina_principal/update_brand",
type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){a=JSON.parse(a);a.error?Swal.fire("Error!",a.error.message,"error"):(brands.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},error:function(a){Swal.fire("Error!","La marca no puedo ser actualizada!","error")}})}});$(document).on("click",".delete_brand",function(){const a=Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});a.fire({title:"Est\u00e1s seguro?",
text:"No podr\u00e1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminalo!",cancelButtonText:"No, cancela!",reverseButtons:!0}).then(b=>{b.value?(b=$(this).attr("b_id"),$.ajax({url:path_url+"/pagina_principal/delete_brand",type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"b_id="+b,success:function(a){a.error?Swal.fire("Error!",a.error.message,"error"):(brands.ajax.reload(null,!1),Swal.fire("Exito!",a.message,"success"))},
error:function(a){Swal.fire("Error!","La marca no pudo ser eliminada!","error")}})):b.dismiss===Swal.DismissReason.cancel&&a.fire("Cancelado","La marca NO fue eliminada","error")})});(function(){let a=0;avisos=$("#tbl_avisos").DataTable({ajax:{url:path_url+"/pagina_principal/leer_avisos",method:"GET",cache:"false",dataSrc:""},columns:[{data:"n_id",render:function(a){return'<input type="hidden" value="'+a+'"/>'},width:".5%"},{data:"n_img",title:"Imagen",render:function(b){return'<img id="img_'+a++ +
'" class="img-thumbnail" width="50px" src="'+path_url+"/"+b+'"/>'}},{data:"username",title:"Usuario"},{data:"n_name",title:"Nombre"},{data:"n_text",title:"Texto"},{data:"n_text_position",title:"Posici\u00f3n",render:function(a){return text_postions[a]}},{data:"n_text_color",title:"Color de texto"},{data:"n_product",title:"Producto"},{data:"n_id",title:"Opciones",render:function(a){return'<div class="text-center"><div class="btn-group"><button n_id="'+a+'" class="btn btn-primary btn-sm edit_notice"><i class="fas fa-edit"></i></button><button type="button" n_id="'+
a+'" class="btn btn-danger btn-sm delete_notice"><i class="fas fa-eraser"></i></button></div></div>'}}],responsive:!0})})();(function(){let a=0;brands=$("#tbl_brands").DataTable({ajax:{url:path_url+"/pagina_principal/read_brands",method:"GET",cache:"false",dataSrc:""},columns:[{data:"b_id",render:function(a){return'<input type="hidden" value="'+a+'"/>'},width:".5%"},{data:"b_img",title:"Imagen",render:function(b){return'<img id="brand_img_'+a++ +'" class="img-thumbnail" width="50px" src="'+path_url+
"/"+b+'"/>'}},{data:"username",title:"Usuario"},{data:"b_name",title:"Nombre"},{data:"b_id",title:"Opciones",render:function(a){return'<div class="text-center"><div class="btn-group"><button b_id="'+a+'" class="btn btn-primary btn-sm edit_brand"><i class="fas fa-edit"></i></button><button type="button" b_id="'+a+'" class="btn btn-danger btn-sm delete_brand"><i class="fas fa-eraser"></i></button></div></div>'}}],responsive:!0})})()});